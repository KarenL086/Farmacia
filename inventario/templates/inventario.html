{% extends './layout/base.html' %}

{% block content %}
    <div class="container-fluid">
        <br>
        <h1><b>Registro de inventario</b></h1>
        <br>
        <div class="container">
            <div class="row">
                <div class="col-sm-8">
                    <form class=" d-flex" action="{% url 'search2' %}">
                        <input type="search" class="form-control ph1" style="background: #ffffff;" name="q" placeholder="&#128270;¿Que medicina está buscando?  ">
                        &nbsp;
                        <button class="buscar " type="submit">Buscar</button>
                        
                    </form>
                    <div class="table-responsive pt-5">
                        <table class="table table-borderless">
                            <thead>
                                <tr>
                                    <th>N° de lote</th>
                                    <th>Producto</th>
                                    <th>Cantidad</th>
                                    <th>Vencimiento</th>
                                    <th>Costo</th>
                                    <th>Venta</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for producto in productos %}
                            <tr>
                                <td>{{ producto.nlote }}</td>  
                                <td>{{ producto.nombre }}</td>
                                <td>{{ producto.cantidad }}</td>  
                                <td>{{ producto.fecha_ven }}</td>  
                                <td>{{ producto.compra }}</td>  
                                <td>{{ producto.precio_venta }}</td>
                                
                                <td>
                                    <button class="btn btn-sm btn-secondary" style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .70rem;">
                                        <a style="text-decoration: none;color: #ffffff;" href="{% url 'modificar' producto.idarticulo %}" type='submit'><i class="bi bi-pencil-square"></i></a>
                                    </button>
                                    &nbsp;
                                    <button class="btn btn-sm btn-danger"  style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .70rem;">
                                        <a style="text-decoration: none;color: #ffffff;" href="{% url 'eliminarProducto' producto.idarticulo %}" type='submit'><i class="bi bi-trash3 biEliminacion"></i></a>
                                    </button>
                                </td>
                            </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="col-sm-4">
                    <!-- <button class="boton btn-lg" href=""><b>Agregar nuevo articulo</b></button> -->
                    <a style="text-decoration: none" href="{% url 'crear' %}" role="button"><button class="buscar boton btn-md"><b>Agregar</b></button></a>

                        <div class="container-md alertas mt-4">
                            <h3><b>AVISOS IMPORTANTES:</b></h3>
                            <h5><b>Disponibilidad de inventario</b></h5>
                            <div class="al center" role="alert">
                                {% for poco in pocos %}
                                    {% if poco.cantidad > 0 %}
                                        <h6><b> &#x26A0; {{poco.nombre}}</b></h6>
                                        <p>Cantidad disponible: {{poco.cantidad}}</p>
                                        {% else %}
                                        <h6><b><i class="bi bi-exclamation-octagon-fill"></i> {{poco.nombre}}</b></h6>
                                        <p>Se agotaron existencias</p>
                                    {% endif %}
                                {% endfor %}
                            </div>
                            <br>
                            <h5><b>Por expirar</b></h5>
                            <div class="al center" role="alert">
                                {% for vencimiento in vencimiento %}
                        
                                    {% if vencimiento.fecha_vencimiento <= actual %}
                                        <h6><b><i class="bi bi-exclamation-octagon-fill"></i> {{ vencimiento.idarticulo }}</b></h6>
                                        <p>Se ha vencido</p>
                                    {% else %}
                                        <h6><b>&#x26A0; {{ vencimiento.idarticulo }}</b></h6>
                                            <p>Vence el {{ vencimiento.fecha_vencimiento }}</p>
                                    {% endif %}
                                    
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock content %}